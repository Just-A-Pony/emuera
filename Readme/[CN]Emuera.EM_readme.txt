名称：Emuera.EM

版本： 1.824
原作者：MinorShift, 妊）|дﾟ)の中の人

修改者：EvilMask
联系方式：evilmask.dev@gmail.com

授权许可：请参照licese.txt。

[关于修改版]

现在HTML_PRINT的<space>标签中param参数可以为负数了。

现在程序运行时不会一直占用图片文件了。

CLEARLINE追加第二个参数(整数，可省略，默认为1)，
第二个参数==0时，不会立刻更新屏幕，直到下一次更新屏幕的命令(例如PRINT系指令)
第二个参数!=0时或省略时，效果和原版相同。

INPUT, INPUTS, ONEINPUT, ONEINPUTS 追加第二参数(整数型，可省略，默认为0)
TINPUT, TINPUTS, TONEINPUT, TONEINPUTS 追加第五参数(整数型，省略可，默认为0)
追加参数==0时，和原版作用相同。
追加参数!=0时或省略时，鼠标点击视作按下回车键，左键时RESULT:1被设为1，右击时RESULT:1被设为2。

ONEINPUT, ONEINPUTS, TONEINPUT, TONEINPUTS 的默认值可以为1位以上数字/字符串

LOADTEXT, SAVETEXT 的第一参数为字符串时，以该参数作为路径读取/保存文件。出于安全考虑，该参数将被强制只能访问Emuera.exe所在文件夹及其子文件夹下面的文件。另外config中「LOADTEXTとSAVETEXTで使える拡張子」的设置项用于决定可以访问具有哪些扩展名的文件。若不符合设置，扩展名将强制变为txt(默认设置只能访问txt文件)
可以以「LOADTEXTとSAVETEXTで使える拡張子:txt,csv,xml」这种方式设置扩展名。

VARSET 现在能改变指定坐标的2、3维数组的对应元素。
	例
	#DIM FOO, 10, 10
	VARSET FOO:3:0, 10, 3, 5
	
	FOO:3:3和FOO:3:4将被赋值为10。

以$开头的标识符会被视为字符串
    例
    LOCALS '= $紅魔館
    与
    LOCALS '= "紅魔館"
    相同

追加的式中函数：
	int EVAL(str value)
	str EVALS(str value)	
		将字符串内容视为表达式，返回表达式的值。
		例：
			#DIMS VAR_A,10
			#DIMS VAR_B
			
			VAR_A:1 = 变量A
			VAR_B = VAR_A

			PRINTSL EVALS(@"%VAR_B%:{ABS(-1)}")
		结果：
			变量A

	int VAREXIST(str value)	
		若定义了与字符串的值同名的变量则根据变量特性返回正数值。未定义则返回0。
		若变量为整数，返回值+1
		若变量为字符串，返回值+2
		若变量为常数，返回值+4
		若变量为二维数组，返回值+8 
		若变量为三维数组，返回值+16
		例：
			#DEFINE VAR_IS_NUM 1
			#DEFINE VAR_IS_STRING 2
			#DEFINE VAR_IS_CONST 4
			#DEFINE VAR_IS_2DARRAY 8
			#DEFINE VAR_IS_3DARRAY 16
			#DIM FOO,10,10

			...

			IF VAREXIST("FOO")==(VAR_IS_NUM|VAR_IS_2DARRAY)
				PRINTL TRUE
			ELSE
				PRINTL FALSE
			ENDIF
			IF VAREXIST("FOO2")
				PRINTL TRUE
			ELSE
				PRINTL FALSE
			ENDIF
		结果：
			TRUE
			FALSE
		
	int FUNCEXIST(str value)	
		若定义了与字符串的值同名的函数(包括式中函数)则返回1(仅限用户定义的函数)。未定义则返回0。

	int ISDEFINED(str value)
		若定义了与字符串的值同名的宏(#DEFINE XXX)则返回1。未定义则返回0。	
		
	int HTML_STRINGLEN(str value)		
		返回字符串显示之后的宽度(半角字符数)，若结果为多行，只返回第一行的宽度
		
	str XML_GET(str xml, str xpath)
		返回xml中对应xpath的InnerXml。如果有多个符合xpath的结果则只返回第一个结果。如果没有则返回空字符串。
		结果的总数将被赋值给RESULT，所有结果的OuterXml将被赋值给RESULTS。
		详细请参考XML和XPath的相关说明文档。	
追加的命令函数：
	SETFORM <FORM字符串>,参数1
	例：
	假设已定义
		#DIM VAR_A,10
		#DIMS VAR_B = "A"
	那么
		SETFORM VAR_%VAR_B%:1, 1
	与
		VAR_A:1 = 1
	的效果相同。

	HTML_SUBSTRING <字符串>,<整数>
	将<字符串>拆分为两个字符串，第一个为<整数>个半角字符长度的字符串，结果保存在RESULTS和RESULTS:1中
	例：
		HTML_SUBSTRING　"AB<b>CD</b>EFG",4
		PRINTSL RESULTS
		PRINTSL RESULTS:1
	结果：
		AB<b>C</b>
		<b>D</b>EFG
		(加粗会使字符比普通字符更宽)

	ENUMFUNCBEGINSWITH <字符串>
	ENUMVARBEGINSWITH <字符串>
	ENUMMACROBEGINSWITH <字符串>
	ENUMFUNCENDSWITH <字符串>
	ENUMVARENDSWITH <字符串>
	ENUMMACROENDSWITH <字符串>
	ENUMFUNCWITH <字符串>
	ENUMVARWITH <字符串>
	ENUMMACROWITH <字符串>
	返回已定义的符号，结果保存在RESULTS中，总数保存在RESULT中
	FUNC代表函数，VAR代表变量，MACRO代表宏
	BEGINSWITH代表检查以<字符串>开头的符号
	ENDSWITH代表检查以<字符串>结尾的符号
	WITH代表检查包含<字符串>的符号
	例:
		#DIM CHAR_NAME
		#DIM CHAR_AGE
		#DIM FLAG_CHAR_ALIVE
		#DIM MAP_TARGET_CHAR

		...

		ENUMVARBEGINSWITH "CHAR"
		; => RESULT = 3
		; => RESULTS = ["CHAR_NAME", "CHAR_AGE", "CHAR_SEX"]
		ENUMVARENDSWITH "CHAR"
		; => RESULT = 1
		; => RESULTS = ["MAP_TARGET_CHAR"]
		ENUMVARWITH "_CHAR_"
		; => RESULT = 1
		; => RESULTS = ["FLAG_CHAR_ALIVE"]

	
	